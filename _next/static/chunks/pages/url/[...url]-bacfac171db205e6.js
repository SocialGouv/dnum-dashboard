(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{50022:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/url/[...url]",function(){return t(18742)}])},18742:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSG:function(){return Xe},default:function(){return Qe}});var n=t(85893),i=t(9008),a=t(74041),s=t(67294),l=t(4314),o=t(75830),c=t(90791),u=t(41027),d=t(34588),f=t(19589),m=t(73973),p=t(49384),h=t(84517),b=t(18121),g=t(20836);function x(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var j=function(e){var r=e.score_modifier,t=r<-50||r<-30?"danger":r<-20?"warning":r<-10?"info":"success";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:r})},y={"content-security-policy":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://owasp.org/www-community/controls/Content_Security_Policy",children:"Doc Content Security Policy"}),". L'extension"," ",(0,n.jsx)("a",{href:"https://github.com/april/laboratory",rel:"noopener noreferrer",target:"_blank",children:"github.com/april/laboratory"})," ","permet de g\xe9n\xe9rer la CSP pour votre application."]}),"x-frame-options":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/X-Frame-Options",children:"Doc header X-Frame-Options"}),"."]}),"strict-transport-security":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security",children:"Doc header Strict-Transport-Security (HSTS)"}),"."]}),"x-content-type-options":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/X-Content-Type-Options",children:"Doc header X-Content-Type-Options"}),"."]}),"x-xss-protection":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection",children:"Doc header X-XSS-Protection"}),"."]}),cookies:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies",children:"OWASP Session Management Cheat Sheet"}),"."]}),"subresource-integrity":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/Security/Subresource_Integrity",children:"Doc Subresource Integrity"}),"."]})},v=[{name:"impact",label:"Impact",render:function(e){return(0,n.jsx)(j,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){x(e,r,t[r])}))}return e}({},e))}},{name:"score_description",label:"Description"},{name:"documentation",label:"Documentation",render:function(e){var r=e.name;return y[r]||"-"}}],w=function(e){var r=e.data;if(!r.url)return null;var t=r&&"https://observatory.mozilla.org/analyze/".concat((0,p.p5)(r.url.replace(/^(https?:\/\/[^/]+).*/,"$1")))||null,i=Object.keys(r.details).filter((function(e){return!r.details[e].pass})).map((function(e){return r.details[e]}));return i.sort((function(e,r){return e.score_modifier-r.score_modifier})),t?(0,n.jsxs)(b.s,{title:"Mozilla HTTP observatory",url:t,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(g.G,{small:!0,grade:r.grade})]}),i.length&&(0,n.jsx)(a.Table,{rowKey:"name",columns:v,data:i})||null]}):(0,n.jsx)(n.Fragment,{})};function _(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function O(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){O(e,r,t[r])}))}return e}function T(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return _(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=(0,t(5152).default)((function(){return Promise.all([t.e(661),t.e(429)]).then(t.bind(t,22429))}),{loadableGenerated:{webpack:function(){return[22429]}},ssr:!1}),A=["#ff6666","#ffce00","#00b353"],P=function(e){var r=T(e.segmentColors||A);return e.reverseColors&&r.reverse(),(0,n.jsx)("div",{style:{background:"#FFF"},children:(0,n.jsx)(k,S({forceRender:!0},e,{segmentColors:r}))})},I=t(63613),N=t(81493),C=t.n(N),F=t(91521),D=t.n(F),E=function(e){var r=e.children,t=e.title,i=e.value;return(0,n.jsxs)("div",{className:D().card,children:[r,t&&(0,n.jsx)("div",{className:D().cardTitle,children:t}),i&&(0,n.jsx)("div",{className:D().cardValue,children:i})]})},L=function(e){var r=0,t=0,n=e;return n>6e4&&(n-=6e4*(r=Math.floor(n/6e4))),n>1e3&&(n-=1e3*(t=Math.floor(n/1e3))),r>0?"".concat(r,"min ").concat((t/100).toFixed(),"s"):"".concat(t,".").concat((n/100).toFixed(),"s")},M=function(e){var r=1e3,t=0,n=0,i=e;return i>1e6&&(i-=(t=Math.floor(i/1e6))*r*r),i>r&&(i-=(n=Math.floor(i/r))*r),t>0?"".concat(t,".").concat((n/100).toFixed(),"Mb"):"".concat(n,".").concat((i/100).toFixed(),"Kb")},R=function(e){var r=e.data,t=e.url;if(!r.audits.metrics.details)return null;var i={"First contentful Paint":r.audits.metrics.details&&r.audits.metrics.details.items&&L(r.audits.metrics.details.items[0].firstContentfulPaint),"Time to interactive":r.audits.metrics.details&&r.audits.metrics.details.items&&L(r.audits.metrics.details.items[0].interactive),"Total requests":r.audits.diagnostics.details&&r.audits.diagnostics.details.items&&r.audits.diagnostics.details.items[0].numRequests,"Total weight":r.audits.diagnostics.details&&r.audits.diagnostics.details.items&&M(r.audits.diagnostics.details.items[0].totalByteWeight)};return r.categories.performance.score=function(e){var r,t,n,i,a=(null===(r=e.audits.diagnostics.details)||void 0===r?void 0:r.items)&&(null===(t=e.audits.diagnostics.details)||void 0===t?void 0:t.items[0].numRequests),s=(null===(n=e.audits.diagnostics.details)||void 0===n?void 0:n.items)&&(null===(i=e.audits.diagnostics.details)||void 0===i?void 0:i.items[0].totalByteWeight),l=1048576,o=100;return a>50&&(o-=Math.min(50,5*(a-50))),s>l&&(o-=Math.min(50,(s-l)/1048576*20)),Math.max(0,o/100)}(r),(0,n.jsxs)(b.s,{title:"LightHouse",info:"Informations collect\xe9es par l'outil Google LightHouse",url:t,urlText:"Rapport LightHouse",isExternal:!0,children:[(0,n.jsx)(a.Row,{children:(0,n.jsx)(a.Col,{children:(0,n.jsx)(I.D,{className:C().accesibility})})}),(0,n.jsx)(a.Row,{children:["accessibility","performance","seo","best-practices"].map((function(e){var t=r.categories[e],i=t.score;return!Number.isNaN(i)&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-6 lg-3",className:"fr-mb-2w",children:(0,n.jsx)(E,{title:t.title,value:"".concat((100*i).toFixed(),"%"),children:(0,n.jsx)(P,{width:180,height:120,value:100*i,minValue:0,maxValue:100,segments:3,currentValueText:""})})},t.id)}))}),(0,n.jsx)(a.Row,{children:Object.keys(i).map((function(e){return(0,n.jsx)(a.Col,{n:"12 sm-12 md-6 lg-3",className:"fr-mb-2w",children:(0,n.jsx)(E,{title:e,value:i[e]})},e)}))})]})};function V(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var H=function(e){var r=e.info&&e.info.severity||"critical",t="critical"===r||"high"===r?"danger":"medium"===r?"warning":"low"===r?"info":"success";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:r})},Z="info,low,medium,high,critical".split(","),z=function(e,r){return Z.indexOf(e.info.severity)-Z.indexOf(r.info.severity)},G=[{name:"severity",label:"S\xe9verit\xe9",render:function(e){return(0,n.jsx)(H,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){V(e,r,t[r])}))}return e}({},e))}},{name:"templateID",label:"id"},{name:"name",label:"Name",render:function(e){return e.info.name}},{name:"matcher_name",label:"Matcher"}],U=function(e){var r=e.data;return r.sort(z),r.length&&(0,n.jsx)(b.s,{title:"Nuclei",info:"D\xe9tection d'erreurs de configuration et vuln\xe9rabilit\xe9s",children:(0,n.jsx)(a.Table,{rowKey:function(e){return e.templateID+e.matcher_name},columns:G,data:r})})||null};function W(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var $=function(e,r){var t=parseInt(r.riskcode)-parseInt(e.riskcode);return 0===t?parseInt(r.confidence)-parseInt(e.confidence):t},K=function(e){var r=e.riskcode,t="0"===r||"1"===r?"info":"2"===r?"warning":"3"===r?"danger":"info";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:e.riskdesc})},q=[{name:"risk",label:"Risk/Confidence",render:function(e){return(0,n.jsx)(K,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){W(e,r,t[r])}))}return e}({},e))}},{name:"name",label:"Name"}],B=function(e){var r=e.data,t=e.url,i=r&&r.site&&r.site.flatMap((function(e){return e.alerts}))||[];return i.sort($),i.length&&(0,n.jsx)(b.s,{isExternal:!0,title:"Scan OWASP",url:t,urlText:"Rapport d\xe9taill\xe9",info:"Scan passif de vuln\xe9rabili\xe9s ZAP OWASP baseline",children:(0,n.jsx)(a.Table,{columns:q,data:i,rowKey:"name"})})||null},X=t(11510);function Q(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var J=["INFO","OK","LOW","MEDIUM","HIGH","CRITICAL"],Y=function(e){return function(r,t,n){return!n.find((function(n,i){return i<t&&n[e]===r[e]}))}},ee=function(e){var r,t=e.data,i=e.url,s=t.find((function(e){return"overall_grade"===e.id})),l=t&&s&&s.finding;t.map((function(e){return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Q(e,r,t[r])}))}return e}({},e,{severity_value:(r=e.severity,J.indexOf(r))});var r})).sort((r="severity_value",function(e,t){return e[r]>t[r]?1:e[r]<t[r]?-1:0})).reverse();var o=t.filter((function(e){return 0===e.id.indexOf("grade_cap_reason_")})).reverse(),c=t.find((function(e){return"cert_notAfter"===e.id})),u=t.find((function(e){return"intermediate_cert_notAfter <#1>"===e.id})),d=null;c&&(d=u?Math.min(new Date(c.finding).getTime(),new Date(u.finding).getTime()):new Date(c.finding).getTime());var f=d&&(new Date).getTime()+2592e6>d;return l&&(0,n.jsx)(b.s,{title:"SSL",info:"Informations sur la qualit\xe9 des certificats SSL via testssl.sh",url:i,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,children:(0,n.jsx)(a.Row,{children:(0,n.jsxs)(a.Col,{children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(g.G,{small:!0,grade:l})]}),o.length>0&&(0,n.jsx)("br",{}),o.filter(Y("finding")).map((function(e){return(0,n.jsx)(a.Alert,{type:"info",title:e.finding},e.finding)})),d&&(0,n.jsxs)("h4",{children:[(0,n.jsx)("br",{}),"Expiration : ",(0,X.Z)(d,"dd/MM/yyyy"),f&&" \u26a0\ufe0f"]})]})})})||null},re=t(25813);function te(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ne(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return te(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return te(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ie=[{name:"name",label:"Cookies"},{name:"domain",label:"Domaine"},{name:"httpOnly",label:"HTTP Only",render:function(e){return e.httpOnly?"\u2714\ufe0f":"\u274c"}},{name:"secure",label:"Secure",render:function(e){return e.secure?"\u2714\ufe0f":"\u274c"}}],ae=function(e){var r=e.cookies;return r&&r.length&&(0,n.jsx)(a.Table,{rowKey:"name",columns:ie,data:r})||null},se=[{name:"type",label:"Type"},{name:"url",label:"URL",render:function(e){return function(e){return(0,n.jsx)("a",{href:e,children:"".concat((0,p.p5)(e).substring(0,25),"...")})}(e.url)}},{name:"details",label:"Rem\xe9diation",render:function(e){var r=e.details;return r&&r.message}}],le=function(e){var r,t=e.trackers;return t&&t.length&&(0,n.jsx)(a.Table,{columns:se,data:t.filter((r=function(e,r){return"unknown"!==e.type&&e.type||r},function(e,t,n){return!n.find((function(n,i){return i<t&&r(n,t)===r(e,t+1)}))})),rowKey:function(e){return e.type+e.url}})||null},oe=[{name:"flag",label:"Flag",render:function(e){if(e.geoip&&e.geoip.country){var r=re.ZP[e.geoip.country.iso_code];return(0,n.jsx)(r,{style:{width:60},title:e.geoip.country.names.fr})}return null}},{name:"hostname",label:"Hostname"},{name:"ip",label:"IP"},{name:"city",label:"City",render:function(e){return e.geoip&&e.geoip.city&&e.geoip.city.names.fr||"?"}},{name:"country",label:"Country",render:function(e){return e.geoip&&e.geoip.country&&e.geoip.country.names.fr||"?"}}],ce=function(e){var r,t=e.endpoints;return t&&t.length&&(0,n.jsx)(a.Table,{columns:oe,data:t.sort((r=function(e){var r,t,n;return(null===(r=e.geoip)||void 0===r||null===(t=r.country)||void 0===t||null===(n=t.names)||void 0===n?void 0:n.fr)||""},function(e,t){return r(e).localeCompare(r(t))})),rowKey:"ip"})||null},ue=function(e){var r,t,i=e.data,s=[];i.cookies&&i.cookies.length&&(r=s).push.apply(r,ne(i.cookies));i.trackers&&i.trackers.length&&(t=s).push.apply(t,ne(i.trackers));return s.length&&(0,n.jsxs)(b.s,{title:"Scripts tiers et cookies",info:"Scripts tiers embarqu\xe9s dans la page web",children:[(0,n.jsx)(ae,{cookies:i.cookies}),(0,n.jsx)(le,{trackers:i.trackers}),(0,n.jsx)(ce,{endpoints:i.endpoints})]})||(0,n.jsx)(b.s,{title:"Third parties",info:"Scripts tiers embarqu\xe9s dans la page web",children:(0,n.jsx)(a.Alert,{type:"success",title:"",description:"Aucun script third-party detect\xe9"})})},de=[{name:"name",label:"Name"},{name:"categories",label:"Categories",render:function(e){var r=e.categories;return r&&r.map((function(e){return e.name})).join(", ")}},{name:"website",label:"Website",render:function(e){var r=e.website;return(0,n.jsx)("a",{href:r,target:"_blank",rel:"nopoener noreferrer",children:r})}}],fe=function(e){var r=e.data;return r&&r.technologies&&r.technologies.length&&(0,n.jsx)(b.s,{title:"Wappalyzer",info:"D\xe9tection des technologies utilis\xe9es",children:(0,n.jsx)(a.Table,{rowKey:"name",columns:de,data:r.technologies})})||null},me=t(83587),pe=t.n(me),he=function(e){var r,t=e.data,i=e.url,s=t&&"https://updown.io/".concat(t.token)||null;return s&&(0,p.p5)(t.url)===(0,p.p5)(i)&&(0,n.jsxs)(b.s,{title:"Disponibilit\xe9 et temps de r\xe9ponse",info:"Informations collect\xe9es par updown.io",url:s,urlText:"Statistiques d\xe9taill\xe9es",isExternal:!0,children:[(0,n.jsxs)(a.Row,{children:[(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(E,{title:"Taux de disponibilit\xe9 sur un mois glissant",value:"".concat(t.uptime,"%"),children:(0,n.jsx)(P,{width:200,height:120,value:t.uptime,minValue:0,maxValue:100,segments:3,currentValueText:""})})}),void 0!==(null===t||void 0===t||null===(r=t.metrics)||void 0===r?void 0:r.apdex)&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(E,{title:"APDEX: Application Performance Index",value:"".concat(t.metrics.apdex),children:(0,n.jsx)(P,{width:200,height:120,value:t.metrics.apdex,minValue:0,maxValue:1,segments:3,currentValueText:""})})}),t.metrics&&t.metrics.timings&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(E,{title:"Temps de r\xe9ponse",value:"".concat(t.metrics.timings.total,"ms"),children:(0,n.jsx)(P,{width:200,height:120,value:Math.max(0,t.metrics.timings.total),minValue:0,maxValue:1e3,customSegmentStops:[0,150,500,1e3],reverseColors:!0,currentValueText:""})})})]}),(0,n.jsx)(a.Row,{className:pe().left,children:(0,n.jsx)(a.Col,{n:"12",className:"fr-mb-3w",children:t.ssl&&(0,n.jsxs)("div",{style:{padding:10},children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Le certificat SSL est"," ",t.ssl.valid?(0,n.jsx)(g.G,{small:!0,grade:"A+",label:"valide"}):(0,n.jsx)(g.G,{small:!0,grade:"F",label:"invalide"})," ","et expire le"," ",(0,n.jsx)("strong",{children:(0,X.Z)(new Date(t.ssl.expires_at),"dd/MM/yyyy",{locale:o.Z})})]})})})]})||(0,n.jsx)(b.s,{title:"Temps de r\xe9ponse",info:"Informations collect\xe9es par updown.io",children:(0,n.jsx)(a.Alert,{variant:"success",children:"Aucune donn\xe9e updown.io associ\xe9e"})})};function be(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ge=function(e,r){var t=new Map;return t.set("CRITICAL",3),t.set("HIGH",2),t.set("MODERATE",1),t.set("LOW",0),t.get(r.securityVulnerability.severity)-t.get(e.securityVulnerability.severity)},xe=function(e){var r=e.securityVulnerability.severity,t="LOW"===r?"info":"MODERATE"===r?"warning":"HIGH"===r||"CRITICAL"===r?"danger":"info";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:r})},je=[{name:"severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(xe,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){be(e,r,t[r])}))}return e}({},e))}},{name:"dependancy",label:"d\xe9pendance vuln\xe9rable",render:function(e){return e.securityVulnerability.package.name}},{name:"vulnerabilities",label:"Vuln\xe9rabilit\xe9s",render:function(e){return e.securityVulnerability.advisory.references.map((function(e,r){return(0,n.jsxs)("p",{children:[(0,n.jsx)("a",{target:"_blank",href:e.url,rel:"noopener noreferrer",children:(0,p.Q_)(e.url)}),(0,n.jsx)("br",{})]},(0,p.Q_)(e.url)+r)}))}}],ye=function(e){var r=e.data,t=(e.url,r&&r.vulnerabilityAlerts.totalCount>0?r.vulnerabilityAlerts.nodes:[]);return r.vulnerabilityAlerts.nodes.sort(ge),r.vulnerabilityAlerts.totalCount>0&&(0,n.jsxs)(b.s,{title:"Alertes Dependabot",url:"".concat(r.url,"/security/dependabot"),urlText:"Alertes dependabot",isExternal:!0,info:(0,n.jsxs)("span",{children:["Vuln\xe9rabilit\xe9s des d\xe9pendances du d\xe9p\xf4t Github"," ",r.url.replace(/^https:\/\/github\.com\/(.*)/,"$1")]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(g.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:je,data:t,rowKey:"createdAt"})]})||null};function ve(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var we=function(e,r){var t=new Map;return t.set("error",1),t.set("warning",0),t.get(r.rule.severity)-t.get(e.rule.severity)},_e=function(e){var r=e.rule.severity,t="warning"===r?"warning":"error"===r?"danger":"info";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:r})},Oe=[{name:"severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(_e,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){ve(e,r,t[r])}))}return e}({},e))}},{name:"rule",label:"R\xe8gle",render:function(e){return e.rule.name}},{name:"description",label:"Description",render:function(e){return(0,n.jsx)("a",{target:"_blank",href:e.html_url,rel:"noopener noreferrer",children:e.rule.description})}}],Se=function(e){var r=e.data,t=(e.url,r&&r.alerts.length>0?r.alerts:[]);return t.sort(we),t.length>0&&(0,n.jsxs)(b.s,{title:"CodeScan",url:"".concat(r.url,"/security/code-scanning"),urlText:"Alertes CodeQL",isExternal:!0,info:(0,n.jsxs)("span",{children:["Scan statique du code du d\xe9p\xf4t Github"," ",r.url.replace(/^https?:\/\/[^/]+\/(.*)/,"$1")]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(g.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:Oe,data:t,rowKey:"rule"})]})||null};function Te(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ke=function(e,r){return e+Number.parseFloat(r.cvss)},Ae=function(e,r){return r.service.vulnerabilities.reduce(ke,0)-e.service.vulnerabilities.reduce(ke,0)},Pe=function(e){return e.vulnerabilities.filter((function(e){return e.is_exploit})).length>0},Ie=function(e){var r=e.vulnerabilities.reduce(ke,0),t=!Pe(e)&&r>5*e.vulnerabilities.length?"warning":Pe(e)&&r>5*e.vulnerabilities.length?"danger":"info";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:t})},Ne=[{name:"severty",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(Ie,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Te(e,r,t[r])}))}return e}({},e))}},{name:"service",label:"Service \xe0 l'\xe9coute",render:function(e){return"".concat(e.name," (port:").concat(e.id,")")}},{name:"vulnerability",label:"Vuln\xe9rabilit\xe9s",render:function(e){return e.vulnerabilities.map((function(e){return(0,n.jsxs)("div",{children:[(0,n.jsx)("a",{target:"_blank",href:"https://vulners.com/cve/".concat(e.id),rel:"noopener noreferrer",children:e.id}),(0,n.jsx)("br",{})]},e.id)}))}}],Ce=function(e){var r=e.data,t=e.url,i=r&&r.open_ports.length>0?r.open_ports:[];return r.open_ports.sort(Ae),r.open_ports.length>0&&(0,n.jsxs)(b.s,{title:"Nmap",url:t,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,info:(0,n.jsxs)("span",{children:["Scan des vuln\xe9rabili\xe9s nmap"," ",(0,n.jsx)("a",{style:{color:"white"},href:"https://".concat(r.host),target:"_blank",rel:"noopener noreferrer",children:"https://".concat(r.host)})]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(g.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:Ne,data:i.map((function(e){return e.service})),rowKey:"id"})]})||null},Fe=function(e){var r=e.data,t=e.url;return r&&(0,n.jsx)(b.s,{title:"Page /stats",info:"Cette page permet de publier vos mesures d'impact",children:"A"===r.grade&&(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsxs)(n.Fragment,{children:["Page bien d\xe9t\xe9ct\xe9e :"," ",(0,n.jsxs)("a",{href:"".concat(t,"/").concat(r.uri),children:[t,"/",r.uri]})]})})||(0,n.jsx)(a.Alert,{type:"error",title:"",description:"La page /stats n'a pas \xe9t\xe9 d\xe9tect\xe9e !"})})||null},De=[{name:"link",label:"URL"}],Ee=function(e){var r=e.data;return r&&r.length&&(0,n.jsx)(b.s,{title:"Erreurs 404",info:"Pages introuvables",children:(0,n.jsx)(a.Table,{rowKey:"link",columns:De,data:r})})||null};function Le(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Me="UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL".split(","),Re=function(e,r){return Me.indexOf(r.Severity)-Me.indexOf(e.Severity)},Ve=function(e){var r=e.Severity,t="LOW"===r||"MEDIUM"===r?"info":"HIGH"===r?"warning":"CRITICAL"===r?"danger":"info";return(0,n.jsx)(h.Z,{className:"w-100",variant:t,children:e.Severity})},He=[{name:"Severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(Ve,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Le(e,r,t[r])}))}return e}({},e))}},{name:"VulnerabilityID",label:"Vulnerability ID",render:function(e){return(0,n.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:e.PrimaryURL,children:e.VulnerabilityID})}},{name:"Title",label:"Titre"}],Ze=function(e){var r=e.data;return(0,n.jsx)(s.Fragment,{children:r.length&&r.map((function(e){var r,t;return e.trivy&&((0,n.jsxs)(b.s,{isExternal:!0,title:"Image docker ".concat(e.name),info:"Scan de vuln\xe9rabilit\xe9s Trivy",children:[(0,n.jsx)("h6",{children:e.trivy.Target}),e.trivy.Vulnerabilities&&e.trivy.Vulnerabilities.length?(0,n.jsx)(a.Table,{columns:He,data:null===(r=e.trivy.Vulnerabilities)||void 0===r?void 0:r.sort(Re).filter((t="VulnerabilityID",function(e,r,n){return!n.find((function(n,i){return i<r&&n[t]===e[t]}))})),rowKey:"VulnerabilityID"}):(0,n.jsx)(a.Alert,{type:"success",title:"",description:"Aucune vuln\xe9rabilit\xe9 d\xe9tect\xe9e par Trivy"})]},e.url)||null)}))||null})},ze=function(e){var r=e.data,t={mention:{"Accessibilit\xe9 : totalement conforme":(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Totalement conforme"})}),"Accessibilit\xe9 : partiellement conforme":(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Partiellement conforme"})}),"Accessibilit\xe9 : non conforme":(0,n.jsx)(a.Alert,{type:"info",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Non conforme"})}),null:(0,n.jsx)(a.Alert,{type:"error",title:"",description:(0,n.jsx)(n.Fragment,{children:"La mention de conformit\xe9 n'a pas \xe9t\xe9 d\xe9tect\xe9e. La mention \xab Accessibilit\xe9 : non conforme \xbb doit \xeatre pr\xe9sente sur chaque page."})})},declaration:{true:(0,n.jsx)(a.Alert,{type:"success",title:"",description:(0,n.jsxs)(n.Fragment,{children:["La d\xe9claration est disponible sur :"," ",(0,n.jsx)("a",{href:r.declarationUrl,target:"_blank",rel:"noopener noreferrer",children:r.declarationUrl})]})}),false:(0,n.jsx)(a.Alert,{type:"error",title:"",description:(0,n.jsxs)(n.Fragment,{children:["La d\xe9claration n'a pas \xe9t\xe9 trouv\xe9e. Utilisez le"," ",(0,n.jsx)("a",{href:"https://betagouv.github.io/a11y-generateur-declaration",target:"_blank",rel:"noopener noreferrer",children:"g\xe9n\xe9rateur de d\xe9claration"})," ","pour en cr\xe9er une."]})})}};return r&&(0,n.jsxs)(b.s,{title:"D\xe9claration de mise en accessibilit\xe9",info:"Une mention de conformit\xe9 pointant sur une d\xe9claration d'accessibilit\xe9 est obligatoire sur les sites et applications de l'\xe9tat",children:[t.mention[r.mention||"null"],t.declaration[""+!!r.declarationUrl]]})||null},Ge=t(73313),Ue=t.n(Ge),We=t(21876).Buffer,$e="/dnum-dashboard",Ke=function(e){var r=e.id;return(0,n.jsx)("div",{id:r})},qe=function(e){return We.from(e).toString("base64")},Be=function(e){var r=e.url,t=e.report,i=e.activeTab,b=void 0===i?0:i,g=t&&t.lhr&&t.lhr.fetchTime;return s.useEffect((function(){var e=document.location.hash.split("#");if(3===e.length){var r=document.getElementById(e[2]);r&&r.scrollIntoView()}}),[t]),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.Callout,{hasInfoIcon:!1,className:"fr-mb-3w",children:[(0,n.jsx)(a.CalloutTitle,{as:"h4",children:(0,n.jsx)("a",{href:r,rel:"noreferrer noopener",target:"_blank",children:r})}),(0,n.jsxs)(a.CalloutText,{children:[t.category&&(0,n.jsx)(h.Z,{className:Ue().badge,variant:"success",to:"/category/".concat(t.category),children:t.category}),t.tags&&t.tags.map((function(e){return(0,n.jsx)(h.Z,{className:Ue().badge,variant:"info",to:"/tag/".concat(e),children:e},e)})),g&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{size:16,className:Ue().clockIcon}),(0,n.jsxs)("span",{title:g,className:Ue().clock,children:["Mise \xe0 jour il y a :"," ",(0,l.Z)(new Date(g),{locale:o.Z})]})]})]}),(0,n.jsx)("div",{className:Ue().image,children:(0,n.jsx)("img",{alt:"Copie d'\xe9cran de ".concat(r),src:"".concat($e,"/report/").concat(qe(r),"/screenshot.jpeg")})})]}),(0,n.jsxs)(a.Tabs,{defaultActiveTab:b,children:[(0,n.jsxs)(a.Tab,{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),"Bonnes pratiques"]}),children:[(0,p.y$)("lighthouse")&&t.lhr&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"lighthouse"}),(0,n.jsx)(R,{data:t.lhr,url:"".concat($e,"/report/").concat(qe(r),"/lhr.html")})]}),(0,p.y$)("thirdparties")&&t.thirdparties&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"thirdparties"}),(0,n.jsx)(ue,{data:t.thirdparties})]}),(0,p.y$)("stats")&&t.stats&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"stats"}),(0,n.jsx)(Fe,{data:t.stats,url:r})]}),(0,p.y$)("declaration-a11y")&&t["declaration-a11y"]&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"declaration-a11y"}),(0,n.jsx)(ze,{data:t["declaration-a11y"]})]}),(0,p.y$)("404")&&t[404]&&t[404].length&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"404"}),(0,n.jsx)(Ee,{data:t[404]})]})||null]}),(0,p.y$)("updownio")&&t.updownio&&(0,n.jsxs)(a.Tab,{label:(0,n.jsxs)("div",{children:[(0,n.jsx)(d.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),"Disponibilit\xe9"]}),children:[(0,n.jsx)(Ke,{id:"updownio"}),(0,n.jsx)(he,{data:t.updownio,url:r})]}),(0,n.jsxs)(a.Tab,{label:(0,n.jsxs)("div",{children:[(0,n.jsx)(f.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),"S\xe9curit\xe9"]}),children:[(0,p.y$)("nmap")&&t.nmap&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"nmap"}),(0,n.jsx)(Ce,{data:t.nmap,url:"".concat($e,"/report/").concat(qe(r),"/nmapvuln.html")})]}),(0,p.y$)("http")&&t.http&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"http"}),(0,n.jsx)(w,{data:t.http})]}),(0,p.y$)("testssl")&&t.testssl&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"testssl"}),(0,n.jsx)(ee,{data:t.testssl,url:"".concat($e,"/report/").concat(qe(r),"/testssl.html")})]}),(0,p.y$)("dependabot")&&t.dependabot&&t.dependabot.repositories&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"dependabot"}),t.dependabot.repositories.filter(Boolean).map((function(e){return(0,n.jsx)(ye,{data:e,url:r},e.url)}))]}),(0,p.y$)("codescan")&&t.codescan&&t.codescan.repositories&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"codescan"}),t.codescan.repositories.filter(Boolean).map((function(e){return(0,n.jsx)(Se,{data:e,url:r},e.url)}))]}),(0,p.y$)("zap")&&t.zap&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"zap"}),(0,n.jsx)(B,{data:t.zap,url:"".concat($e,"/report/").concat(qe(r),"/zap.html")})]}),(0,p.y$)("nuclei")&&t.nuclei&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"nuclei"}),(0,n.jsx)(U,{data:t.nuclei})]}),(0,p.y$)("trivy")&&t.trivy&&t.trivy.length&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"trivy"}),(0,n.jsx)(Ze,{data:t.trivy})]})||null]}),(0,n.jsx)(a.Tab,{label:(0,n.jsxs)("div",{children:[(0,n.jsx)(m.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),"Informations"]}),children:(0,p.y$)("wappalyzer")&&t.wappalyzer&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ke,{id:"wappalyzer"}),(0,n.jsx)(fe,{data:t.wappalyzer})]})})]})]}):(0,n.jsxs)("div",{children:["No data available for",r]})},Xe=!0,Qe=function(e){var r=e.report,t=e.url,s=e.activeTab;return r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.default,{children:(0,n.jsxs)("title",{children:["DashLord - ",t]})}),(0,n.jsx)(Be,{url:t,report:r,activeTab:s})]}):(0,n.jsx)(a.Alert,{type:"error",title:"Impossible de trouver le rapport"})}},84517:function(e,r,t){"use strict";var n=t(85893),i=t(94184),a=t.n(i),s=(t(67294),t(11163)),l=t(32905),o=t.n(l);r.Z=function(e){var r=e.children,t=e.variant,i=e.className,l=e.to,c=(0,s.useRouter)();return(0,n.jsx)("button",{type:"button",className:a()(i,o()[t]),onClick:function(){l&&c.push(l)},children:r})}},20836:function(e,r,t){"use strict";t.d(r,{G:function(){return o}});var n=t(85893),i=(t(67294),t(84517)),a=t(42779),s=t.n(a),l={A:"success",B:"info",C:"info",D:"warning",E:"warning",F:"danger"},o=function(e){var r=e.grade,t=e.warning,a=e.label,o=e.to,c=e.small,u="".concat(r).substring(0,1).toUpperCase(),d=l[u]||"danger",f=void 0!==a?a:r;return(0,n.jsxs)(i.Z,{variant:d,className:s()[c?"small":"big"],to:o,children:[f,t&&(0,n.jsx)("span",{title:t,style:{marginLeft:5},children:"\u26a0\ufe0f"})]})}},18121:function(e,r,t){"use strict";t.d(r,{s:function(){return f}});var n=t(85893),i=(t(67294),t(94184)),a=t.n(i),s=t(79223),l=t(73973),o=t(83206),c=t(41664),u=t(75670),d=t.n(u),f=function(e){var r=e.title,t=e.children,i=e.info,u=e.url,f=e.urlText,m=void 0===f?"":f,p=e.className,h=e.isExternal,b=void 0!==h&&h;return(0,n.jsxs)("div",{className:a()(d().container,p),children:[(0,n.jsxs)("div",{className:d().banner,children:[(0,n.jsx)("h5",{className:d().mainTitle,children:r}),i&&(0,n.jsx)(s.Z,{overlay:i,children:(0,n.jsx)(l.Z,{size:20,style:{marginLeft:5,cursor:"pointer"}})}),u&&(b?(0,n.jsx)("a",{style:{float:"right"},href:u,target:"_blank",rel:"noreferrer noopener",children:m}):(0,n.jsx)(c.default,{prefetch:!1,href:u,children:(0,n.jsxs)("a",{style:{float:"right"},children:[m,(0,n.jsx)(o.Z,{})]})}))]}),(0,n.jsx)("div",{className:d().body,children:t})]})}},63613:function(e,r,t){"use strict";t.d(r,{D:function(){return i}});var n=t(85893),i=(t(67294),function(e){var r=e.className;return(0,n.jsxs)("div",{className:r,children:["Moins de 25% des crit\xe8res d'accessibilit\xe9 peuvent \xeatre test\xe9s automatiquement, ",(0,n.jsx)("strong",{children:"une expertise manuelle est requise"}),".",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Ce score ne repr\xe9sente pas le score RGAA mais une partie des bonnes pratiques de base \xe0 appliquer."]})})},32905:function(e){e.exports={success:"badge_success__HjgKW",info:"badge_info__eK6GA",warning:"badge_warning__5QJuG",danger:"badge_danger__Lexxg"}},91521:function(e){e.exports={card:"card_card__afbUo",cardValue:"card_cardValue__zfpCd",cardTitle:"card_cardTitle__LRcj8"}},42779:function(e){e.exports={small:"grade_small__EU1s6",big:"grade_big__iN2Jf"}},81493:function(e){e.exports={accesibility:"lightHouse_accesibility__k5UoB"}},75670:function(e){e.exports={container:"panel_container__s3lQL",banner:"panel_banner__IDWUZ",mainTitle:"panel_mainTitle__N5MWp",body:"panel_body___c3aS"}},83587:function(e){e.exports={center:"updownIo_center__VX4HF",left:"updownIo_left__Uik_F",expiration:"updownIo_expiration__dGB_i"}},73313:function(e){e.exports={badge:"url_badge__giqcN",clockIcon:"url_clockIcon__mEI2N",clock:"url_clock__Jh8L8",image:"url_image__8lAEe"}}},function(e){e.O(0,[774,6,241,510,933,888,179],(function(){return r=50022,e(e.s=r);var r}));var r=e.O();_N_E=r}]);